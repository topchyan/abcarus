<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  img-src 'self' data: blob:;
  style-src 'self' 'unsafe-inline';
  script-src 'self' 'unsafe-eval';
  font-src 'self' data:;
  connect-src 'self' data: blob: file:;
  media-src 'self' data: blob: file:;
">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ABCarus</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="stylesheet" href="../../third_party/tabulator/tabulator.min.css" />
  <link rel="stylesheet" href="./library_modal.css" />
</head>

<body>
	  <header>
	    <div class="header-row header-row-top">
	      <div class="left-controls controls">
	        <div class="segmented" aria-label="Library">
	          <button id="btnToggleLibrary" title="Toggle Library Tree (Ctrl+L). Shift-click: Library Catalog (Ctrl+Shift+L)">
              <svg class="btn-icon icon-library" aria-hidden="true"><use href="#ui-library"></use></svg>
              <span class="btn-text">Library</span>
            </button>
	        </div>
	        <div class="segmented" aria-label="File">
	          <button id="btnFileNew" type="button" title="New file (Ctrl+N)">
              <svg class="btn-icon icon-file-plus" aria-hidden="true"><use href="#ui-file-plus"></use></svg>
              <span class="btn-text">New File</span>
            </button>
	          <button id="btnFileOpen" type="button" title="Open (Ctrl+O)">
              <svg class="btn-icon icon-folder-open" aria-hidden="true"><use href="#ui-folder-open"></use></svg>
              <span class="btn-text">Open</span>
            </button>
	          <button id="btnFileSave" type="button" title="Save (Ctrl+S)">
              <svg class="btn-icon icon-save" aria-hidden="true"><use href="#ui-save"></use></svg>
              <span class="btn-text">Save</span>
            </button>
	          <button id="btnFileClose" type="button" title="Close file (Ctrl+W)">
              <svg class="btn-icon icon-file-x" aria-hidden="true"><use href="#ui-file-x"></use></svg>
              <span class="btn-text">Close</span>
            </button>
	          <button id="btnToggleRaw" type="button" title="Toggle raw file mode">
              <svg class="btn-icon icon-file-code" aria-hidden="true"><use href="#ui-file-code"></use></svg>
              <span class="btn-text">Raw</span>
            </button>
	        </div>
        </div>
        <div class="center-controls controls">
	        <div class="segmented" aria-label="Transport">
	          <button id="btnPlayPause" type="button" title="Play / Pause (F5)">
              <svg class="btn-icon icon-play" aria-hidden="true"><use href="#ui-play"></use></svg>
              <svg class="btn-icon icon-pause" aria-hidden="true"><use href="#ui-pause"></use></svg>
              <span class="btn-text">Play</span>
            </button>
	          <button id="btnStop" type="button" title="Stop (Esc)">
              <svg class="btn-icon icon-stop" aria-hidden="true"><use href="#ui-stop"></use></svg>
              <span class="btn-text">Stop</span>
            </button>
	        </div>
		        <div class="practice-controls" aria-label="Playback controls">
		          <label id="practiceTempoWrap" class="practice-tempo" hidden>
		            <span>Speed</span>
		            <select id="practiceTempo" aria-label="Playback speed">
		              <option value="0.5">50%</option>
	              <option value="0.6">60%</option>
	              <option value="0.7">70%</option>
	              <option value="0.8">80%</option>
	              <option value="0.9">90%</option>
	              <option value="1" selected>100%</option>
	              <option value="1.1">110%</option>
		              <option value="1.2">120%</option>
		            </select>
		          </label>
		          <label id="practiceLoopWrap" class="practice-loop" hidden>
		            <input id="practiceLoopEnabled" type="checkbox" />
		            <span>Loop</span>
		            <input id="practiceLoopFrom" class="practice-loop-num" type="number" inputmode="numeric" min="0" step="1" placeholder="from" title="Loop from measure (0 = first bar)" />
		            <span class="practice-loop-arrow">→</span>
		            <input id="practiceLoopTo" class="practice-loop-num" type="number" inputmode="numeric" min="0" step="1" placeholder="to" title="Loop to measure (0 = end)" />
		          </label>
		        </div>
		      </div>
		      <div class="right-controls">
		        <div class="segmented" aria-label="Preferences">
		          <button id="btnFonts" type="button" title="Fonts and soundfonts">
	              <svg class="btn-icon icon-type" aria-hidden="true"><use href="#ui-type"></use></svg>
	              <span class="btn-text">Fonts</span>
	            </button>
		        </div>
		        <div class="segmented" aria-label="View">
			          <button id="btnFocusMode" title="Playback focus mode (F7)" aria-label="Playback focus mode" aria-pressed="false">
		              <span class="btn-text">Focus</span>
		            </button>
			          <button id="btnToggleSplit" title="Toggle split orientation (Ctrl+Alt+\)" aria-label="Toggle split orientation" aria-pressed="false">
		              <span class="btn-text">Split</span>
		            </button>
			          <button id="btnResetLayout" title="Reset view (layout + zoom) (F8)" aria-label="Reset view (layout and zoom)">
		              <svg class="btn-icon icon-reset" aria-hidden="true"><use href="#ui-reset"></use></svg>
		              <span class="btn-text">Reset view</span>
		            </button>
			        </div>
		      </div>
		    </div>
		  </header>

    <svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" style="position:absolute;width:0;height:0;overflow:hidden" aria-hidden="true" focusable="false">
      <symbol id="ui-library" viewBox="0 0 24 24">
        <rect width="8" height="18" x="3" y="3" rx="1"></rect>
        <path d="M7 3v18"></path>
        <path d="M20.4 18.9c.2.5-.1 1.1-.6 1.3l-1.9.7c-.5.2-1.1-.1-1.3-.6L11.1 5.1c-.2-.5.1-1.1.6-1.3l1.9-.7c.5-.2 1.1.1 1.3.6Z"></path>
      </symbol>
      <symbol id="ui-file-plus" viewBox="0 0 24 24">
        <path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path>
        <path d="M14 2v5a1 1 0 0 0 1 1h5"></path>
        <path d="M9 15h6"></path>
        <path d="M12 18v-6"></path>
      </symbol>
      <symbol id="ui-file-x" viewBox="0 0 24 24">
        <path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path>
        <path d="M14 2v5a1 1 0 0 0 1 1h5"></path>
        <path d="m14.5 12.5-5 5"></path>
        <path d="m9.5 12.5 5 5"></path>
      </symbol>
      <symbol id="ui-file-code" viewBox="0 0 24 24">
        <path d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"></path>
        <path d="M14 2v5a1 1 0 0 0 1 1h5"></path>
        <path d="M10 12.5 8 15l2 2.5"></path>
        <path d="m14 12.5 2 2.5-2 2.5"></path>
      </symbol>
      <symbol id="ui-folder-open" viewBox="0 0 24 24">
        <path d="m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"></path>
      </symbol>
      <symbol id="ui-save" viewBox="0 0 24 24">
        <path d="M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"></path>
        <path d="M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"></path>
        <path d="M7 3v4a1 1 0 0 0 1 1h7"></path>
      </symbol>
      <symbol id="ui-play" viewBox="0 0 24 24">
        <path d="M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z"></path>
      </symbol>
      <symbol id="ui-pause" viewBox="0 0 24 24">
        <rect x="14" y="3" width="5" height="18" rx="1"></rect>
        <rect x="5" y="3" width="5" height="18" rx="1"></rect>
      </symbol>
      <symbol id="ui-stop" viewBox="0 0 24 24">
        <rect width="18" height="18" x="3" y="3" rx="2"></rect>
      </symbol>
      <symbol id="ui-reset" viewBox="0 0 24 24">
        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
        <path d="M3 3v5h5"></path>
      </symbol>
      <symbol id="ui-type" viewBox="0 0 24 24">
        <path d="M12 4v16"></path>
        <path d="M4 7h16"></path>
        <path d="M4 17h16"></path>
      </symbol>
      <symbol id="ui-repeat" viewBox="0 0 24 24">
        <path d="m17 2 4 4-4 4"></path>
        <path d="M3 11v-1a4 4 0 0 1 4-4h14"></path>
        <path d="m7 22-4-4 4-4"></path>
        <path d="M21 13v1a4 4 0 0 1-4 4H3"></path>
      </symbol>
      <symbol id="ui-plus" viewBox="0 0 24 24">
        <path d="M5 12h14"></path>
        <path d="M12 5v14"></path>
      </symbol>
      <symbol id="ui-minus" viewBox="0 0 24 24">
        <path d="M5 12h14"></path>
      </symbol>
    </svg>

  <main>
	    <aside class="sidebar">
	      <div class="sidebar-header">
	        <div class="sidebar-controls">
	          <div class="library-root-row">
	            <button id="btnLibraryRefresh" class="sidebar-action" type="button" title="Refresh library">Refresh</button>
	            <div class="library-root" id="libraryRoot" title="">Library: (none)</div>
	          </div>
	          <div class="scan-status" id="scanStatus">Idle</div>
	          <div class="sidebar-control">
	            <div class="sidebar-label">Group by:</div>
	            <select id="groupBy">
              <option value="file">File</option>
              <option value="x">X (Reference)</option>
              <option value="composer">C (Composer)</option>
              <option value="meter">M (Meter)</option>
              <option value="key">K (Key)</option>
              <option value="unit">L (Unit Length)</option>
              <option value="tempo">Q (Tempo)</option>
              <option value="rhythm">R (Rhythm)</option>
              <option value="source">S (Source)</option>
              <option value="origin">O (Origin)</option>
              <option value="group">G (Group)</option>
            </select>
          </div>
          <div class="sidebar-control">
            <div class="sidebar-label">Sort by:</div>
            <select id="sortBy">
              <option value="file_asc">File/Tune Asc</option>
              <option value="file_desc">File/Tune Desc</option>
              <option value="count_asc">Tune Count Asc</option>
              <option value="count_desc">Tune Count Desc</option>
              <option value="update_asc">Update Asc</option>
              <option value="update_desc" selected>Update Desc</option>
            </select>
          </div>
	          <div class="sidebar-control sidebar-search">
	            <div class="sidebar-label">Filter:</div>
	            <input id="librarySearch" type="text" placeholder="Title, composer, key…" />
	            <button id="btnLibraryClearFilter" class="sidebar-action" type="button" title="Clear filter">Clear</button>
	          </div>
	        </div>
	      </div>
	      <div class="sidebar-body">
	        <div class="tree" id="libraryTree"></div>
	        <div class="sidebar-split" id="sidebarSplit" role="separator" aria-orientation="horizontal" tabindex="0"></div>
      </div>
    </aside>

    <div class="divider" id="paneDivider" role="separator" aria-orientation="vertical" tabindex="0"></div>

	    <section class="pane right">
	      <div class="file-header-panel" id="fileHeaderPanel">
	        <div class="file-header-bar">
	          <button id="fileHeaderToggle" class="file-header-title header-state" type="button" title="No file header in this file.">
	            <span class="header-state-label">Header</span>
            <span id="headerStateMarker" class="header-state-marker" aria-hidden="true">—</span>
          </button>
          <select id="fileTuneSelect"></select>
	          <button id="btnNewTune" class="file-tune-action" type="button" title="New Tune (Add to Active File) (Cmd/Ctrl+Alt+N)" aria-label="New Tune">
	            <svg class="btn-icon icon-plus" aria-hidden="true"><use href="#ui-plus"></use></svg>
	          </button>
          <button id="btnTemplates" class="file-tune-action" type="button" title="Templates…" aria-label="Templates">
            <svg class="btn-icon icon-library" aria-hidden="true"><use href="#ui-library"></use></svg>
          </button>
          <button id="scanErrorTunes" class="scan-error-button" type="button" hidden>Scan for errors</button>
          <button id="errorsIndicator" class="errors-indicator" type="button" aria-label="Errors" hidden disabled>
            Errors: 0
          </button>
          <span id="errorsFocusMessage" class="errors-focus-message" hidden></span>
          <div class="file-header-toggles controls segmented" aria-label="Mode toggles">
            <button id="btnToggleErrors" type="button" title="Toggle errors features">Errors</button>
            <button id="btnToggleFollow" type="button" title="Toggle playback follow">Follow</button>
            <button id="btnToggleGlobals" type="button" title="Toggle global header">Globals</button>
          </div>
	          <div class="file-header-meta">
	            <div class="dirty-indicator" id="dirtyIndicator" aria-live="polite"></div>
	          </div>
	        </div>
	        <div id="fileHeaderEditor" class="file-header-editor" aria-label="File header"></div>
        <div class="file-header-actions">
          <button id="fileHeaderSave" type="button">Save Header</button>
          <button id="fileHeaderReload" type="button">Reload</button>
        </div>
      </div>
      <div class="right-split">
        <div class="editor-pane">
          <div id="abc-editor"></div>
        </div>
        <div class="split-divider" id="splitDivider" role="separator" aria-orientation="vertical" tabindex="0"></div>
    <div class="render-pane">
      <div id="out"></div>
    </div>
  </div>
</section>
</main>

  <div id="intonationExplorerPanel" class="tool-panel hidden" role="dialog" aria-label="Intonation Explorer" aria-hidden="true">
    <div class="tool-panel-card">
      <div class="tool-panel-header">
        <span class="tool-panel-title">Intonation Explorer</span>
        <button id="intonationExplorerClose" type="button" class="tool-panel-close" aria-label="Close Explorer">×</button>
      </div>
      <div class="tool-panel-controls">
        <label class="tool-panel-control">
          <span>Tonal Base</span>
          <div class="tool-panel-base-row">
            <select id="intonationExplorerBaseMode" aria-label="Tonal base mode">
              <option value="auto" selected>Auto</option>
              <option value="manual">Manual</option>
              <option value="fromK">From K:</option>
            </select>
            <input id="intonationExplorerBaseManual" type="text" placeholder="0–52 (e.g. 0 or pc53=0)" />
          </div>
        </label>
        <label class="tool-panel-control">
          <span>Sort</span>
          <select id="intonationExplorerSort" aria-label="Sort mode">
            <option value="count" selected>Count</option>
            <option value="first">First appearance</option>
            <option value="pitch">Scale (low→high)</option>
            <option value="rel">pc53 (relative)</option>
            <option value="abs">pc53 (absolute)</option>
            <option value="abc">ABC spelling</option>
          </select>
        </label>
        <label class="tool-panel-control tool-panel-control-inline">
          <span>Options</span>
          <label class="tool-panel-checkbox">
            <input id="intonationExplorerSkipGrace" type="checkbox" checked />
            <span>Ignore grace notes</span>
          </label>
        </label>
        <button id="intonationExplorerRefresh" type="button">Refresh</button>
      </div>
      <div id="intonationExplorerStatus" class="tool-panel-status" aria-live="polite"></div>
      <div class="tool-panel-table">
        <table>
          <thead>
            <tr>
              <th scope="col">pc53</th>
              <th scope="col">Perde</th>
              <th scope="col">ABC (effective)</th>
              <th scope="col">Weight</th>
            </tr>
          </thead>
          <tbody id="intonationExplorerTableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <footer class="taskbar">
		    <div class="taskbar-left">
		      <div id="status">Ready</div>
		      <div id="hoverStatus" class="hover-status" aria-live="polite"></div>
		      <div id="toolStatus" class="tool-status" aria-live="polite"></div>
		    </div>
		    <div id="cursorStatus" class="cursor-status"></div>
		    <div id="bufferStatus" class="buffer-status" aria-live="polite"></div>
		  </footer>
		  <div id="toast" class="toast" role="status" aria-live="polite"></div>

			  <div id="errorsPopover" class="errors-popover hidden" role="dialog" aria-label="Errors list">
			    <div class="errors-popover-header">
			      <span id="errorsPopoverTitle">Errors</span>
			    </div>
			    <div id="errorsList" class="errors-list"></div>
			  </div>

  <div class="modal" id="templatesModal" aria-hidden="true">
    <div class="modal-card templates-card" role="dialog" aria-label="Templates">
      <div class="modal-header">
        <div class="modal-title">Templates</div>
        <button id="templatesClose" class="modal-close" type="button" aria-label="Close">×</button>
      </div>
      <div class="templates-toolbar">
        <input id="templatesSearch" type="text" placeholder="Search templates…" />
        <div class="templates-folder" id="templatesFolderLabel" title=""></div>
        <button id="templatesManage" type="button" title="Open templates folder">Manage…</button>
        <button id="templatesChangeFolder" type="button" title="Choose another templates folder">Change…</button>
        <button id="templatesReload" type="button" title="Reload templates list">Reload</button>
      </div>
      <div class="templates-body">
        <div class="templates-list" id="templatesList" role="listbox" aria-label="Templates list"></div>
        <div class="templates-preview">
          <div class="templates-preview-title" id="templatesPreviewTitle">Select a template</div>
          <pre class="templates-preview-text" id="templatesPreviewText"></pre>
        </div>
      </div>
      <div class="templates-actions">
        <button id="templatesInsert" type="button" disabled>Insert</button>
        <button id="templatesCancel" type="button">Cancel</button>
      </div>
    </div>
  </div>
	
  <div class="modal" id="settingsModal" aria-hidden="true">
    <div class="modal-card settings-card" role="dialog" aria-label="Settings">
      <div class="modal-header">
        <div class="modal-title">Settings</div>
        <div class="settings-header-controls" aria-label="Settings controls">
          <div class="segmented" role="group" aria-label="Settings mode">
            <button id="settingsModeBasic" type="button" aria-pressed="true">Basic</button>
            <button id="settingsModeAdvanced" type="button" aria-pressed="false">Advanced</button>
          </div>
          <label class="settings-search">
            <span class="settings-search-label">Search</span>
            <input id="settingsFilter" type="text" aria-label="Search settings" placeholder="Search…" />
          </label>
        </div>
        <!-- Legacy control kept for compatibility until settings.js is updated (Prompt 4). -->
        <button class="modal-close" id="settingsClose" type="button" hidden>Close</button>
      </div>
      <div class="modal-body">
        <div class="settings-layout" aria-label="Settings layout">
          <div class="settings-nav">
            <!-- Legacy control kept for compatibility; hidden in the new UI (Prompt 4 removes reliance). -->
            <input id="settingsShowAdvanced" type="checkbox" hidden />
            <div class="settings-tabs" id="settingsTabs" role="tablist" aria-label="Settings sections"></div>
          </div>
          <div class="settings-content">
            <div class="settings-section-header" aria-label="Settings section">
              <div id="settingsSectionTitle" class="settings-section-title"></div>
              <div id="settingsSectionHint" class="settings-section-hint"></div>
            </div>
            <div id="settingsNoResults" class="settings-no-results hidden" role="status" aria-live="polite"></div>
            <div class="settings-panels" id="settingsPanels"></div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <div class="modal-footer-left">
          <button id="settingsExport" type="button">Export…</button>
          <button id="settingsImport" type="button">Import…</button>
          <button id="settingsResetSection" type="button">Defaults</button>
        </div>
        <button id="settingsCancel" type="button">Cancel</button>
        <button id="settingsApply" type="button">Apply</button>
        <button id="settingsOk" class="primary" type="button">OK</button>
        <!-- Legacy control kept for compatibility until settings.js is updated (Prompt 4). -->
        <button id="settingsReset" type="button" hidden>Reset Defaults</button>
      </div>
    </div>
  </div>

  <div class="modal" id="moveTuneModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-label="Move Tune">
      <div class="modal-header">
        <div class="modal-title">Move Tune</div>
        <button class="modal-close" id="moveTuneClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <label class="settings-row">
          <span>Target file</span>
          <select id="moveTuneTarget"></select>
        </label>
      </div>
      <div class="modal-footer">
        <button id="moveTuneApply" class="primary" type="button">Move</button>
        <button id="moveTuneCancel" type="button">Cancel</button>
      </div>
    </div>
  </div>

  <div class="modal" id="aboutModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-label="About">
      <div class="modal-header">
        <div class="modal-title">About ABCarus</div>
        <button class="modal-close" id="aboutClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <pre id="aboutInfo" class="about-info"></pre>
      </div>
      <div class="modal-footer">
        <button id="aboutCopy" type="button">Copy</button>
      </div>
    </div>
  </div>

	  <div class="modal" id="setListModal" aria-hidden="true">
	    <div class="modal-card" role="dialog" aria-label="Set List">
	      <div class="modal-header">
	        <div class="modal-title">Set List</div>
	        <div class="set-list-header-controls">
	          <button id="setListHeader" type="button">Header…</button>
	          <button class="modal-close" id="setListClose" type="button">Close</button>
	        </div>
	      </div>
	      <div class="modal-body">
	        <div id="setListEmpty" class="set-list-empty">
	          Add tunes to build an ordered list, preview it, and export it as a new .abc file.
	        </div>
	        <div id="setListItems" class="set-list-items" hidden></div>
	      </div>
	      <div class="modal-footer">
	        <div class="modal-footer-left">
	          <label class="set-list-inline">
	            <span>Page breaks</span>
	            <select id="setListPageBreaks">
	              <option value="perTune">Per tune</option>
	              <option value="none">None</option>
              <option value="auto">Auto</option>
            </select>
          </label>
          <label class="set-list-inline">
            <input id="setListCompact" type="checkbox" />
            <span>Compact spacing</span>
          </label>
        </div>
        <button id="setListClear" type="button">Clear</button>
        <button id="setListSaveAbc" class="primary" type="button">Export ABC…</button>
        <button id="setListExportPdf" type="button">Export PDF…</button>
        <button id="setListPrint" type="button">Print…</button>
      </div>
    </div>
  </div>

  <div class="modal" id="setListHeaderModal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-label="Set List Header">
      <div class="modal-header">
        <div class="modal-title">Set List Header</div>
        <button class="modal-close" id="setListHeaderClose" type="button">Close</button>
      </div>
      <div class="modal-body">
        <div class="set-list-empty">
          This header is inserted at the top of exported Set List files and used for Set List print/PDF rendering.
        </div>
        <textarea id="setListHeaderText" rows="10" spellcheck="false"></textarea>
      </div>
      <div class="modal-footer">
        <button id="setListHeaderReset" type="button">Reset</button>
        <button id="setListHeaderSave" class="primary" type="button">Save</button>
      </div>
    </div>
  </div>

	  <div class="modal" id="xIssuesModal" aria-hidden="true">
	    <div class="modal-card" role="dialog" aria-label="X Issues">
	      <div class="modal-header">
	        <div class="modal-title">X issues</div>
	        <button class="modal-close" id="xIssuesClose" type="button">Close</button>
	      </div>
	      <div class="modal-body">
	        <pre id="xIssuesInfo" class="about-info"></pre>
	      </div>
	      <div class="modal-footer">
	        <button id="xIssuesAutoFix" type="button">Auto-fix: Renumber X…</button>
	        <button id="xIssuesJump" type="button">Jump</button>
	        <button id="xIssuesCopy" type="button">Copy</button>
	      </div>
	    </div>
	  </div>

	  <div class="modal" id="printAllOptionsModal" aria-hidden="true">
	    <div class="modal-card print-all-options-card" role="dialog" aria-label="Print All Tunes">
	      <div class="modal-header">
	        <div class="modal-title">Print All Tunes</div>
	      </div>
	      <div class="modal-body">
	        <div class="print-all-row">
	          <label class="print-all-label" for="printAllPageBreaks">Page breaks</label>
	          <select id="printAllPageBreaks">
	            <option value="perTune">Per tune</option>
	            <option value="continuous">Continuous (use %%newpage)</option>
	          </select>
	        </div>
	        <label class="print-all-inline" for="printAllRemember">
	          <input id="printAllRemember" type="checkbox" />
	          <span>Remember (change later in Settings → Print → All tunes)</span>
	        </label>
	      </div>
	      <div class="modal-footer">
          <div class="modal-footer-left">
	          <button id="printAllOptionsOk" class="primary" type="button">OK</button>
          </div>
	        <button id="printAllOptionsCancel" type="button">Cancel</button>
	      </div>
	    </div>
	  </div>

	  <div class="modal" id="disclaimerModal" aria-hidden="true">
	    <div class="modal-card" role="dialog" aria-label="Early-stage release">
	      <div class="modal-header">
	        <div class="modal-title">Early-stage release</div>
	      </div>
      <div class="modal-body">
        <p>ABCarus is functional but still under active development. Expect changes and keep backups.</p>
      </div>
      <div class="modal-footer">
        <button id="disclaimerOk" class="primary" type="button">OK</button>
      </div>
    </div>
  </div>

  <div id="libOverlay" class="lib-overlay" hidden>
    <div class="lib-modal" role="dialog" aria-modal="true" aria-label="Library Catalog">
      <div class="lib-header">
        <div class="lib-header-top">
          <div class="lib-title">Library Catalog</div>
          <button id="libClose" class="lib-x" type="button" aria-label="Close">×</button>
        </div>
        <div class="lib-header-bottom">
          <div class="lib-hint">Tip: use Quick filter to search; double-click a row to open.</div>
          <div class="lib-controls">
            <label class="lib-label">
              Quick filter
              <input id="libFilter" class="lib-input" type="text" autocomplete="off" />
            </label>
            <button id="libOpen" class="lib-btn primary" type="button" disabled>Open</button>
          </div>
        </div>
      </div>
      <div class="lib-body">
        <div id="libTable" class="lib-table"></div>
      </div>
      <div class="lib-footer">
        <div id="libStatus" class="lib-status" aria-live="polite"></div>
      </div>
    </div>
  </div>

  <script src="../../third_party/abc2svg/abc2svg-1.js"></script>
  <script src="../../third_party/abc2svg/snd-1.js"></script>
  <script src="../../third_party/tabulator/tabulator.min.js"></script>
  <script type="module" src="./renderer.js"></script>
  <script src="./library_modal.js"></script>

</body>

</html>
